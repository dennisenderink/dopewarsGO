"use strict";function removeSlide(t){t.removeClass("c-slide--active").addClass("c-slide--remove")}function updateCash(t){$("[js-cash]").find("span").html(t),cashCurr=parseInt($("[js-cash]").find("span").html())}function Dope(t,e,o,n){this.name=t,this.priceMin=e,this.priceMax=o,this.amount=n,this.priceCurr=function(){var t=Math.random();return this.random=t,Math.floor((o-e+1)*t+e)},dopelist.push(this)}function updateButtons(){dopelist.forEach(function(t){var e=$('[data-js-dope="'+t.name+'"]'),o=parseInt(e.find("[js-dope-amount]").html()),n=e.find("[js-dope-sell]").find(".button--trade");o<=0?n.addClass("button--disabled"):n.removeClass("button--disabled");var a=parseInt(e.find("[js-dope-price]").html()),s=e.find("[js-dope-buy]").find(".button--trade");a>cashCurr?s.addClass("button--disabled"):s.removeClass("button--disabled");var i=$("[js-inv-curr]").html();$("[js-inv-max]").html()-i<=0&&s.addClass("button--disabled")})}function buttonTrade(t,e){if(!t.hasClass("button--disabled")){var o,n=t.closest("tr"),a=n.attr("data-js-dope"),s=parseInt(n.find("[js-dope-price]").html());o="tap"===e?t.hasClass("button--buy")?1:-1:t.hasClass("button--buy")?Math.floor(cashCurr/s):-1*n.find("[js-dope-amount]").html();var i=$("[js-inv-curr]").html(),d=$("[js-inv-max]").html()-i;o>d&&(o=d),updateCash(cashCurr-s*o),updateDopeAmount(a,o),updateButtons()}}function updateDopeAmount(t,e){for(var o in dopelist)dopelist[o].name==t&&(dopelist[o].amount+=e,$('[data-js-dope="'+t+'"]').find("[js-dope-amount]").html(dopelist[o].amount));updateInv(e)}function updateInv(t){var e=parseInt($("[js-inv-curr]").html())+t;$("[js-inv-curr]").html(e)}function updateDay(){parseInt($("[js-day-curr]").html())==parseInt($("[js-day-max]").html())?(dopelist.forEach(function(t){var e=$('[data-js-dope="'+t.name+'"]'),o=parseInt(e.find("[js-dope-amount]").html());if(o>0){var n=parseInt(e.find("[js-dope-price]").html());updateCash(cashCurr+n*o),updateDopeAmount(e,o),updateButtons()}}),removeSlide($(this).closest(".c-slide")),alert("Your final score is: "+$("[js-cash]").find("span").html()),window.location.reload(!0)):($("[js-day-curr]").html(parseInt($("[js-day-curr]").html())+1),setRandomPrices())}function setRandomPrices(){dopelist.forEach(function(t){var e=$('[data-js-dope="'+t.name+'"]').find("[js-dope-price]");e.html(t.priceCurr());var o="rgb(255,255,255)";if(t.random>.5){var n=Math.floor(255-255*(t.random-.5));o="rgb(255,"+n+","+n+")"}else{var a=Math.floor(255-255*(.5-t.random));o="rgb("+a+",255,"+a+")"}e.css("color",o)}),updateButtons()}function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,showError):x.innerHTML="Geolocation is not supported by this browser."}function showPosition(t){x.innerHTML="Latitude: "+t.coords.latitude+"<br />Longitude: "+t.coords.longitude}function showError(t){switch(t.code){case t.PERMISSION_DENIED:x.innerHTML="User denied the request for Geolocation.";break;case t.POSITION_UNAVAILABLE:x.innerHTML="Location information is unavailable.";break;case t.TIMEOUT:x.innerHTML="The request to get user location timed out.";break;case t.UNKNOWN_ERROR:x.innerHTML="An unknown error occurred."}}function initScreen(){screenHeight=$(".c-slide--active").height(),$(".s-site").height(screenHeight)}$("[js-slide-button]").each(function(){$(this).on("click",function(){$(".c-slide").removeClass("c-slide--remove");var t=$(this).attr("js-slide-target");$("[js-slide__"+t+"]").addClass("c-slide--active"),$(this).closest(".c-slide").removeClass("c-slide--active").addClass("c-slide--remove"),initScreen()})}),$.fn.digits=function(){return this.each(function(){$(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))})};var cashStart=2e3,cashCurr=cashStart;updateCash(cashStart);var dopelist=[],dope1=new Dope("Acid",1e3,4400,0),dope2=new Dope("Cocaine",15e3,29e3,0),dope3=new Dope("Hashish",480,1280,0),dope4=new Dope("Heroin",5500,13e3,0),dope5=new Dope("Ludes",11,60,0),dope6=new Dope("MDA",1500,4400,0),dope7=new Dope("Opium",540,1250,0),dope8=new Dope("PCP",1e3,2500,0),dope9=new Dope("Peyote",220,700,0),dope10=new Dope("Shrooms",630,1300,0),dope11=new Dope("Speed",90,250,0),dope12=new Dope("Weed",315,890,0);dopelist.forEach(function(t){$("[js-dope-table-content]").append('        <tr js-dope data-js-dope="'+t.name+'">            <td>'+t.name+"</td>            <td js-dope-amount>"+t.amount+'</td>            <td js-dope-sell><button class="button button--trade button--sell">-</button></td>            <td js-dope-price></td>            <td js-dope-buy><button class="button button--trade button--buy">+</button></td>        </tr>    ')}),$.event.special.tap.tapholdThreshold=400,$(".button--trade").on("tap",function(){buttonTrade($(this),"tap")}).on("taphold",function(){buttonTrade($(this),"taphold")}),$("[js-button-scootch]").on("tap",function(){updateDay()}),setRandomPrices();var x=$(".geolocation"),screenHeight;$(window).load(function(){initScreen()}),function(t){t.fn.nodDoubleTapZoom=function(){t(this).bind("touchstart",function(e){var o=e.timeStamp,n=o-(t(this).data("lastTouch")||o),a=e.originalEvent.touches.length;t(this).data("lastTouch",o),!n||n>500||a>1||(e.preventDefault(),t(e.target).trigger("click"))})}}(jQuery),$(document).on("pagecreate",".s-site",function(){$("body").nodDoubleTapZoom()});