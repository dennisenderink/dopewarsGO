"use strict";function removeSlide(e){e.removeClass("c-slide--active").addClass("c-slide--remove")}function updateCash(e){$("[js-cash]").find("span").html(e),cashCurr=parseInt($("[js-cash]").find("span").html())}function Dope(e,t,n,o){this.name=e,this.priceMin=t,this.priceMax=n,this.amount=o,this.priceCurr=function(){var e=Math.random();return this.random=e,Math.floor((n-t+1)*e+t)},dopelist.push(this)}function updateButtons(){dopelist.forEach(function(e){var t=$('[data-js-dope="'+e.name+'"]'),n=parseInt(t.find("[js-dope-amount]").html()),o=t.find("[js-dope-sell]").find(".button--trade");n<=0?o.addClass("button--disabled"):o.removeClass("button--disabled");var a=parseInt(t.find("[js-dope-price]").html()),s=t.find("[js-dope-buy]").find(".button--trade");a>cashCurr?s.addClass("button--disabled"):s.removeClass("button--disabled");var i=$("[js-inv-curr]").html();$("[js-inv-max]").html()-i<=0&&s.addClass("button--disabled")})}function buttonTrade(e,t){if(!e.hasClass("button--disabled")){var n,o=e.closest("tr"),a=o.attr("data-js-dope"),s=parseInt(o.find("[js-dope-price]").html());n="tap"===t?e.hasClass("button--buy")?1:-1:e.hasClass("button--buy")?Math.floor(cashCurr/s):-1*o.find("[js-dope-amount]").html();var i=$("[js-inv-curr]").html(),r=$("[js-inv-max]").html()-i;n>r&&(n=r),updateCash(cashCurr-s*n),updateDopeAmount(a,n),updateButtons()}}function updateDopeAmount(e,t){for(var n in dopelist)dopelist[n].name==e&&(dopelist[n].amount+=t,$('[data-js-dope="'+e+'"]').find("[js-dope-amount]").html(dopelist[n].amount));updateInv(t)}function updateInv(e){var t=parseInt($("[js-inv-curr]").html())+e;$("[js-inv-curr]").html(t)}function updateDay(){parseInt($("[js-day-curr]").html())==parseInt($("[js-day-max]").html())?(dopelist.forEach(function(e){var t=$('[data-js-dope="'+e.name+'"]'),n=parseInt(t.find("[js-dope-amount]").html());if(n>0){var o=parseInt(t.find("[js-dope-price]").html());updateCash(cashCurr+o*n),updateDopeAmount(t,n),updateButtons()}}),removeSlide($(this).closest(".c-slide")),alert("Your final score is: "+$("[js-cash]").find("span").html()),window.location.reload(!0)):($("[js-day-curr]").html(parseInt($("[js-day-curr]").html())+1),setRandomPrices(),randomEvents())}function setRandomPrices(){dopelist.forEach(function(e){var t=$('[data-js-dope="'+e.name+'"]').find("[js-dope-price]");t.html(e.priceCurr());var n="rgb(255,255,255)";if(e.random>.5){var o=Math.floor(255-255*(e.random-.5));n="rgb(255,"+o+","+o+")"}else{var a=Math.floor(255-255*(.5-e.random));n="rgb("+a+",255,"+a+")"}t.css("color",n)}),updateButtons()}function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,showError):x.innerHTML="Geolocation is not supported by this browser."}function showPosition(e){x.innerHTML="Latitude: "+e.coords.latitude+"<br />Longitude: "+e.coords.longitude}function showError(e){switch(e.code){case e.PERMISSION_DENIED:x.innerHTML="User denied the request for Geolocation.";break;case e.POSITION_UNAVAILABLE:x.innerHTML="Location information is unavailable.";break;case e.TIMEOUT:x.innerHTML="The request to get user location timed out.";break;case e.UNKNOWN_ERROR:x.innerHTML="An unknown error occurred."}}function initScreen(){screenHeight=$(".c-slide--active").height(),$(".s-site").height(screenHeight)}function Event(e,t){this.name=e,this.chance=t,eventList.push(this)}function getEventChange(e,t){return e.chance*(100/t)}function getRandomEvent(e){for(var t=0;t<e.length;t++)if(e[t].chance>=100*eventRNG)return eventRNG=Math.random(),e[t]}function randomEvents(){Math.random()>=0&&randomChanceFire()}function randomChanceFire(){var e=getRandomEvent(eventMap);window[e.name]()}function officerHardass(){alert("Officer Hardass is chasing you!")}function dopeRaid(){alert("dopeRaid")}function dopeSupply(){alert("dopeSupply!")}function dopeFound(){alert("dopeFound")}function findCoat(){alert("findCoat")}function pennyFound(){alert("pennyFound")}function marrakeshExpress(){alert("marrakeshExpress")}$("[js-slide-button]").each(function(){$(this).on("click",function(){$(".c-slide").removeClass("c-slide--remove");var e=$(this).attr("js-slide-target");$("[js-slide__"+e+"]").addClass("c-slide--active"),$(this).closest(".c-slide").removeClass("c-slide--active").addClass("c-slide--remove"),initScreen()})}),$.fn.digits=function(){return this.each(function(){$(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))})};var cashStart=2e3,cashCurr=cashStart;updateCash(cashStart);var dopelist=[],dope1=new Dope("Acid",1e3,4400,0),dope2=new Dope("Cocaine",15e3,29e3,0),dope3=new Dope("Hashish",480,1280,0),dope4=new Dope("Heroin",5500,13e3,0),dope5=new Dope("Ludes",11,60,0),dope6=new Dope("MDA",1500,4400,0),dope7=new Dope("Opium",540,1250,0),dope8=new Dope("PCP",1e3,2500,0),dope9=new Dope("Peyote",220,700,0),dope10=new Dope("Shrooms",630,1300,0),dope11=new Dope("Speed",90,250,0),dope12=new Dope("Weed",315,890,0);dopelist.forEach(function(e){$("[js-dope-table-content]").append('        <tr js-dope data-js-dope="'+e.name+'">            <td>'+e.name+"</td>            <td js-dope-amount>"+e.amount+'</td>            <td js-dope-sell><button class="button button--trade button--sell">-</button></td>            <td js-dope-price></td>            <td js-dope-buy><button class="button button--trade button--buy">+</button></td>        </tr>    ')}),$.event.special.tap.tapholdThreshold=400,$(".button--trade").on("tap",function(){buttonTrade($(this),"tap")}).on("taphold",function(){buttonTrade($(this),"taphold")}),$("[js-button-scootch]").on("tap",function(){updateDay()}),setRandomPrices();var x=$(".geolocation"),screenHeight;$(window).load(function(){initScreen()}),function(e){e.fn.nodDoubleTapZoom=function(){e(this).bind("touchstart",function(t){var n=t.timeStamp,o=n-(e(this).data("lastTouch")||n),a=t.originalEvent.touches.length;e(this).data("lastTouch",n),!o||o>500||a>1||(t.preventDefault(),e(t.target).trigger("click"))})}}(jQuery),$(document).on("pagecreate",".s-site",function(){$("body").nodDoubleTapZoom()});var eventList=[],eventChance=0,eventRNG=Math.random(),event1=new Event("oldLady",10),event2=new Event("officerHardass",20),event3=new Event("dopeRaid",5),event4=new Event("dopeSupply",20),event5=new Event("dopeFound",30),event6=new Event("findCoat",5),event7=new Event("pennyFound",20),event7=new Event("marrakeshExpress",10),eventTotal=0;eventList.forEach(function(e){eventTotal+=e.chance});var eventMap=[],range=0;eventList.forEach(function(e){range+=getEventChange(e,eventTotal),eventMap.push(new Event(e.name,range))});