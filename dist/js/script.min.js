"use strict";function updateCash(t){$("[js-cash]").find("span").html(t),cashCurr=parseInt($("[js-cash]").find("span").html())}function Dope(t,e,o,s){this.name=t,this.priceMin=e,this.priceMax=o,this.amount=s,this.priceCurr=function(){var t=Math.random();return this.random=t,Math.floor((o-e+1)*t+e)},dopelist.push(this)}function updateButtons(){dopelist.forEach(function(t){var e=$('[data-js-dope="'+t.name+'"]'),o=parseInt(e.find("[js-dope-amount]").html()),s=e.find("[js-dope-sell]").find(".button--trade");o<=0?s.addClass("button--disabled"):s.removeClass("button--disabled");var n=parseInt(e.find("[js-dope-price]").html()),a=e.find("[js-dope-buy]").find(".button--trade");n>cashCurr?a.addClass("button--disabled"):a.removeClass("button--disabled");var d=$("[js-inv-curr]").html();$("[js-inv-max]").html()-d<=0&&a.addClass("button--disabled")})}function buttonClick(){if(!$(this).hasClass("button--disabled")){var t=$(this).closest("tr"),e=t.attr("data-js-dope");if($(this).hasClass("button--buy"))o=1;else var o=-1;var s=parseInt(t.find("[js-dope-price]").html());updateCash(cashCurr-s*o),updateDopeAmount(e,o),updateButtons()}}function buttonHeld(){console.log("button held!");var t=$(this);console.log(t);var e=$(this).closest("tr"),o=e.attr("data-js-dope"),s=parseInt(e.find("[js-dope-price]").html());if($(this).hasClass("button--buy"))n=Math.floor(cashCurr/s);else var n=-1*e.find("[js-dope-amount]").html();var a=$("[js-inv-curr]").html(),d=$("[js-inv-max]").html()-a;n>d&&(n=d);var i=parseInt(e.find("[js-dope-price]").html());updateCash(cashCurr-i*n),updateDopeAmount(o,n),updateButtons()}function updateDopeAmount(t,e){for(var o in dopelist)dopelist[o].name==t&&(dopelist[o].amount+=e,$('[data-js-dope="'+t+'"]').find("[js-dope-amount]").html(dopelist[o].amount));updateInv(e)}function updateInv(t){console.log(t);var e=parseInt($("[js-inv-curr]").html())+t;$("[js-inv-curr]").html(e)}function updateDay(){parseInt($("[js-day-curr]").html())==parseInt($("[js-day-max]").html())?(alert("Your final score is: "+$("[js-cash]").find("span").html()),window.location.reload(!0)):($("[js-day-curr]").html(parseInt($("[js-day-curr]").html())+1),setRandomPrices())}function setRandomPrices(){dopelist.forEach(function(t){var e=$('[data-js-dope="'+t.name+'"]').find("[js-dope-price]");e.html(t.priceCurr());var o="rgb(255,255,255)";if(t.random>.5){var s=Math.floor(255-255*(t.random-.5));o="rgb(255,"+s+","+s+")"}else{var n=Math.floor(255-255*(.5-t.random));o="rgb("+n+",255,"+n+")"}e.css("color",o)}),updateButtons()}function getLocation(){navigator.geolocation?navigator.geolocation.watchPosition(showPosition):x.innerHTML="Geolocation is not supported by this browser."}function showPosition(t){x.innerHTML="Latitude: "+t.coords.latitude+"<br />Longitude: "+t.coords.longitude}function initScreen(){screenHeight=$(".c-slide--active").height(),$(".s-site").height(screenHeight)}$("[js-slide-button]").each(function(){$(this).on("click",function(){$(".c-slide").removeClass("c-slide--remove");var t=$(this).attr("js-slide-target");$("[js-slide__"+t+"]").addClass("c-slide--active"),$(this).closest(".c-slide").removeClass("c-slide--active").addClass("c-slide--remove"),initScreen()})});var cashStart=2e3,cashCurr=cashStart;updateCash(cashStart);var dopelist=[],dope1=new Dope("Acid",1e3,4400,0),dope2=new Dope("Cocaine",15e3,29e3,0),dope3=new Dope("Hashish",480,1280,0),dope4=new Dope("Heroin",5500,13e3,0),dope5=new Dope("Ludes",11,60,0),dope6=new Dope("MDA",1500,4400,0),dope7=new Dope("Opium",540,1250,0),dope8=new Dope("PCP",1e3,2500,0),dope9=new Dope("Peyote",220,700,0),dope10=new Dope("Shrooms",630,1300,0),dope11=new Dope("Speed",90,250,0),dope12=new Dope("Weed",315,890,0);dopelist.forEach(function(t){$("[js-dope-table-content]").append('        <tr js-dope data-js-dope="'+t.name+'">            <td>'+t.name+"</td>            <td js-dope-amount>"+t.amount+'</td>            <td js-dope-sell><button class="button button--trade button--sell">-</button></td>            <td js-dope-price></td>            <td js-dope-buy><button class="button button--trade button--buy">+</button></td>        </tr>    ')}),$(".button--trade").on("tap",buttonClick).on("taphold",buttonHeld),$("[js-button-scootch]").on("tap",function(){updateDay()}),setRandomPrices();var x=document.getElementById("geolocation"),screenHeight;$(window).load(function(){initScreen()});